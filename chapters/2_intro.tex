% % Should be 25% of the total paper, i.e. 3-5 pages
% **Problems**

% - Too much detail (technical and about industry)
% - Technically detailed stuff, both load cell and LTE-M vs NB-IoT


% **Needs to contain**

% - Example of real world applications
% - High level concepts only regarding technical implementation
% - Figures & drawings

% **Structure**

% - IoT general info
% - Intro about Vetek
% - Vetek + IoT
% - Challenges
% - Available tech
% - What I did
% - Road map to other chapters

% Paragraph of IoT
IoT (Internet of Things) is a broad, diverse and growing field within the IT sector. Many organizations predict that it will come to impact large areas of our daily life, and many telecom companies are experimenting with different kind of real world applications that can benefit from this change. The basic idea is the same for everything, which is to take a device and connect it to the internet. Examples range from simple toasters to complex self-driving cars.\cite{what_is_iot} The focus is to enable communication between devices without the need for a human middleman, thus optimizing whatever application is being implemented. A simple example is a building equipped with multiple IoT-enabled thermostats, which are controlled by a central heating system. Given effective software, heating can be regulated in an energy efficient manner while still keeping visitors adequately warm throughout the day. Another example might be a parking meter, which can forward the availability of its parking spot to some central system which in turn forwards the closest available spot to an end-user. The potential applications are numerous, but factors such as energy consumption and security have proven huge roadblocks that pose huge challenges to most IoT projects.

% Intro about Vetek
Vetek is a Swedish scale supplier located in Väddö, situated approx. 100 kilometers north of Stockholm. Vetek constructs their own scales and weighing systems, as well as reselling products from other manufacturers.\cite{vetek} 

% Vetek + IoT
Vetek aims to improve their services, and as such are interested in the possible use cases of IoT technology, and ultimately see how that can be applied to their own products. With something as simple as an IoT-enabled scale, they can offer customers products that can be placed in remote areas without needing constant checkups, enabling long term monitoring and easier analyzation of data. An example might be monitoring road salt depots, to enable smarter refill routes during winter time, or a fodder station to map the behaviors of local wildlife.

% Challenges
The biggest challenges for this type of device lies in energy consumption and broadcast range. Low energy consumption is needed so that any maintainer doesn't need to make constant check-ups to switch batteries all the time. This poses limitation on the type of scale that can be used, which in extension affects parameters such as scale accuracy and capacity. A wide broadcast range is needed so that the device isn't limited by having to be close to a base station. This puts restraints on what type of communication protocols can be used, as traditional ones such as Wi-Fi and Bluetooth won't work in the aforementioned examples.

% Available tech
With the advent of IoT, the 3GPP (a standardization organization for telecom) has developed new wireless communication protocols intended to be used by these devices. One of these, the NB-IoT (Narrowband-IoT) protocol is particularly suitable for the challenges mentioned above, as its focus lies (among else) in wide area coverage and long battery life. A microcontroller (a small computer) is needed to handle the data polled from the scale, as well as sending it via some wireless communication protocol. The microcontroller chosen for this project is a FiPy, as it has the capability to handle multiple wireless technologies, one of them being NB-IoT. The only other technology needed is some form of power source, as well as an ADC (Analog-to-Digital Converter) that connects the microcontroller and the scale.

% What I did
In this paper, an attempt is made to implement the above. Due to hardware difficulties, a functioning connection between the scale and the microcontroller couldn't be established, so a virtual scale was implemented instead. Some behavioral restrictions are placed on the code running the microcontroller, to closer resemble a real-world application. Examples of these behaviors are handling of erroneous data and disconnection of the scale.

% Road map to other chapters





% This paper will focus on the implementation of an IoT device, and highlight the practical and structural challenges that need to be taken into account when starting this kind of project. The aim of this paper is to familiarize the reader with the basic workings and needs of such a device, and leave them with a rough idea of what they need to do to implement their own device with an appropriate sensor. 

% The IoT device that will be implemented is a basic microcontroller connected to a load cell. The practical work can be divided into two parts: enabling communication between the load cell and microcontroller, as well as connecting the microcontroller to a cloud service.

% The signal output of a load cell is in mV/V\cite{load-cell-spec}. Simply put, what this means is that when the loading cell is at full weight capacity, it will output \textit{x} amount of mV per V the device is supplied. \eg a load cell with the full scale output of 3.0 mV/V, and the recommended excitation of 10V, will output 3.0 * 10 = 30 mV at full weight capacity. The remaining range of 0-30mV is used to signify the remaining range of the weight capacity from 0 to \textit{x} kgs. To correctly tie these signals to a weight unit, a calibration is needed. To send this electric analog signal to a microcontroller, we will need some form of ADC (Analog-to-Digital Converter). Considering the system as a whole, we need to power the load cell, ADC and microcontroller with the same power source and ground, as to not cause any electrical interference throughout the different parts. Practically, this means that the choice of hardware will be affected by what voltage the power source is able to provide. Ideally, the microcontroller, ADC and load cell would all require the same amount of voltage as to not overcomplicate the model and make of the power source.

% To enable wireless communication with some form of web service, the microcontroller will need to be fitted with a adequate wireless protocol. It would seem suitable that we would opt for one of the previously mentioned LPWAN technologies that the 3GPP (a telecom standard development organization\cite{3gpp}) developed for the specific purpose of being used with IoT devices. The two major flagships are NB-IoT (Narrowband IoT) and LTE-MTC (Long Term Evolution-Machine Type Communication [also known as CAT-M1]). The major differences between them can roughly be summed up as LTE-M having a higher data rate and NB-IoT enabling longer battery life. Additional differences will be explained in more detail in the next chapter. Both of these technologies enable wireless communications to the net via cell towers. From a hardware perspective, the only thing needed on the user end is a SIM-card from the telecom company that has enabled the corresponding technology in their network, as well as a compatible microcontroller. 

% The practical reasons for enabling wireless communications with load cell sensor in particular are many. Any form of application where weight needs to be measured overtime can benefit from such a device, whether it's about simply measuring trends over time or sending an alarm at a specific threshold value. With the addition of LPWAN technology, use cases in remote areas such as forests and deep underground locations are possible. Examples might range from measuring which sand depots that need refills when salting roads during winter, measuring the amount of lime depot that's being fed into a watercourse to affect the pH value, or reporting activity at a fodder station in hunting season. 


% \section{Purpose and Goals}

% The goal of this paper is to familiarize the reader with an IoT device. Practically, this will be done by establish a working internet connection with a load cell through a microcontroller and documenting the process. The data sent from the load cell should be functionally identical to the data produced if the load cell was offline. Disregarding problems due to a internet service provider, data speeds and losses should not be abnormal. Using the same components, replication of the project should be feasible with the documentation provided in this thesis, assuming similar software and service providers remain. Additionally, some software design choices will be discussed in regards to aspects that benefit an IoT device, specifically issues such as battery life.


% \section{Delimitations}
% The end goal of the paper is to document and outline the steps needed to implement a functioning data upload from a load cell to the internet via NB-IoT. The final implementation will not be a functional product ready to be taken into commercial use. Any extra improvements upon a NB-IoT enabled load cell will only be done if time remains after the implementation and the completion of the thesis. The reason for this is due to a limited time budget, since this project is done within the framework for a bachelor's thesis.

% % % TODO: [Comment] Does this part makes sense based on material in previous paragraphs? Maybe better suited for later?
% % When starting this project, several factors motivated the choice for hardware. Since existing work on NB-IoT at Uppsala university has been done on the microcontroller FiPy, and the available expertise would make troubleshooting simpler, a FiPy was chosen for this project as well. Furthermore, since the Computer Communications group at Uppsala University have an ongoing contract(\textbf{wording?}) to use Telia's NB network, the choice for which tele-carrier to use was also quite simple. The load cell, a Tedea Huntleigh - Model 1022 was provided by Vetek, as it was deemed a simple and basic model which would be suitable for this kind of pilot project. Since the output of a load cell is measured in mV/V\cite{load-cell-spec}, some form of mediator is needed between the microcontroller and the load cell. A similar implementation made at KTH \cite{hospital} used a load cell amplifier, HX711, to convert the data to a digital format. After some research online, no alternatives were cheap or simple enough to warrant a different purchase. The readily available documentation and tutorials were also a compelling argument for using the HX711. 

